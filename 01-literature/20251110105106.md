---
title: Kap 4.2.3 Binære optimaliseringer i en sirkulær kø
id: 20251110105354
tags: []
---

# [4.2.3]([[20250818102829]]) Binære optimaliseringer i en sirkulær kø

## Konsept
- TabellKø bruker en sirkulær tabell (array) som intern datastruktur.
- Tabellen dobles i størrelse ved utvidelse: 8 → 16 → 32 → …  
  Altså alltid n = 2^k.

## Binærtriks
- Hvis n = 2^k, og 0 ≤ m < n:  
  m & (n-1) = m  
  n & (n-1) = 0  
  (Setning 4.2.3 a) – ruller indekser rundt i køen uten modulus.)

- For negative tall m med -n ≤ m < 0:  
  m + n = m & (n-1)  
  (Setning 4.2.3 b – effektiv beregning av antall elementer.)

## Optimalisering av metoder

- leggInn(T verdi)  
  a[til] = verdi, til = (til + 1) & (a.length - 1), dobbel tabell hvis full.

- taUt()  
  Sjekk tom kø, lagre a[fra], nuller a[fra], øk fra = (fra + 1) & (a.length - 1).

- antall()  
  returner (til - fra) & (a.length - 1).

## Konstruktør med tilpasset lengde
- Hvis ønsket lengde ikke er en potens av 2, velg neste større 2^k:  
  lengde = lengde ≤ 1 ? 1 : Integer.highestOneBit(lengde - 1) << 1  
  a = ny tabell med lengde `lengde`; fra = til = 0.

## Konklusjon
- Effektivitetsgevinsten er marginal.
- Teknikken for å hoppe over "skjøten" i en sirkulær tabell er interessant og elegant.