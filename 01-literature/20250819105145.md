---
title: Heap's algorithm
id: 20250819105159
tags: []
---

# [Heap's algorithm](https://en.wikipedia.org/wiki/Heap%27s_algorithm)
Heap's algorithm is an algorithm for in-place permuting.
It generates every possible permutation of n objects by swapping 2 objects without disturbing the other n-2 objects. It does this until it's traversed all permutations.
Below is heap's algorithm implemented in rust:
```rust
fn heap_permutation(a: &mut Vec<i32>, k: usize) {
    if k == 1 {
        println!("{:?}", a);
    } else {
        heap_permutation(a, k - 1);

        for i in 0..k-1 {
            if k % 2 == 0 {
                a.swap(i, k - 1);
            } else {
                a.swap(0, k - 1);
            }
            heap_permutation(a, k - 1);
        }
    }
}
```

Say we perform this algorithm with the input $[1, 2, 3, 4]$ and length $k = 4$.

## Step 1(k = 4)(a = [1, 2, 3, 4]):
Recursive call function with k = 3.

## Step 2(k = 3)(a = [1, 2, 3, 4]):
Recursive call function with k = 2.

## Step 3(k = 2)(a = [1, 2, 3, 4]):
Recursive call function with k = 1.

## Step 4(k = 1)(a = [1, 2, 3, 4]):
Traverse **$[1, 2, 3, 4]$**. Finished.

## Step 5(k = 2)(a = [1, 2, 3, 4]):
Return to previous layer. For loop with:
- i = 0:
  - Swap: $[2, 1, 3, 4]$
  - Recursive call to function with k = 1.

## Step 6(k = 1)(a = [2, 1, 3, 4]):
Traverse **$[2, 1, 3, 4]$**. Finished.

## Step 7(k = 2)(a = [2, 1, 3, 4]):
Finished.

## Step 8(k = 3)(a = [2, 1, 3, 4]):
For loop with:
- i = 0:
    - swap: [3, 1, 2, 4]
    - Recursive call to function with k = 2, a=[3, 1, 2, 4]
        - Recursive call to function with k = 1, a=[3, 1, 2, 4]
            - Traverse **$[3, 1, 2, 4]$**. Finished.
        - A run with k = 2 swaps 0 and 1 and calls recursively:
            - swap: [1, 3, 2, 4].
            - Recursive with k=1, a=[1, 3, 2, 4]
                - Traverse **$[1, 3, 2, 4]$**. Finished.
        - Finished.
      Finished.
- i = 1:
    - swap: [2, 1, 3, 4]

At this point I gave up on understanding intuitively how it works. It just works.